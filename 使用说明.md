# 游戏自动化脚本 GUI 编辑器 - 快速使用指南

## 🚀 快速上手

### 步骤1：安装依赖
双击运行 `安装依赖.bat` 文件，等待安装完成。

### 步骤2：启动程序
双击运行 `启动GUI.bat` 文件，程序将自动启动。

### 步骤3：设置全局快捷键
1. 点击工具栏中的"快捷键设置"按钮
2. 设置启动和停止快捷键（默认：`启动，ESC停止）
3. 点击"确定"保存设置

### 步骤4：创建自动化脚本
1. 点击"添加步骤"按钮
2. 选择步骤类型（鼠标点击、键盘按键、图片搜索、等待）
3. 在右侧编辑面板中设置参数
4. 点击"保存步骤"确认
5. 重复以上步骤创建完整的自动化流程

### 步骤5：执行脚本
**方法1：GUI按钮执行**
1. 点击"开始执行"按钮
2. 程序将按顺序执行所有步骤
3. 可以随时点击"停止执行"来终止

**方法2：全局快捷键执行**
1. 按设置的启动快捷键（默认：`键）
2. 程序将自动开始执行
3. 按停止快捷键（默认：ESC键）来终止

## 📋 常用功能

### 鼠标点击
- **获取当前位置**：将鼠标移动到目标位置，点击此按钮获取坐标
- **截图选择**：通过截图直接点击选择目标位置
- **偏移量**：在基础位置上添加偏移，用于精确定位

### 图片搜索
- **选择图片**：选择要搜索的图片文件
- **截图获取**：通过截图创建搜索目标图片
- **匹配度**：调整图片匹配的精确度（0.8为推荐值）

### 全局快捷键
- **启动快捷键**：在任何时候按下启动快捷键都可以开始执行脚本
- **停止快捷键**：按下停止快捷键可以立即终止脚本执行
- **自定义设置**：通过"快捷键设置"按钮可以自定义快捷键

### 配置管理
- **保存配置**：将当前步骤保存为配置文件
- **打开配置**：加载之前保存的配置文件
- **新建配置**：清空当前步骤，创建新的配置

## 🛠️ 实用技巧

### 1. 快捷键使用技巧
- **全局快捷键**：无需程序窗口在前台，任何时候都可使用
- **常用快捷键**：建议使用F键或反引号等不常用的键
- **快速切换**：可以在游戏中快速启动/停止脚本

### 2. 图片识别技巧
- 选择清晰、独特的图片区域
- 避免包含变化的文本或动画
- 建议图片大小适中（50x50 到 200x200 像素）

### 3. 坐标定位技巧
- 使用"获取当前位置"获得精确坐标
- 使用"截图选择"进行可视化定位
- 设置适当的偏移量进行微调

### 4. 执行流程优化
- 在关键步骤间添加等待时间
- 使用"测试此步骤"验证单个步骤
- 逐步构建复杂的自动化流程

## 🔧 故障排除

### 常见问题
1. **程序启动失败**
   - 确保已安装Python 3.8+
   - 运行"安装依赖.bat"安装必要组件

2. **快捷键不响应**
   - 检查是否有其他程序占用了相同快捷键
   - 尝试更换不同的快捷键组合
   - 确保程序具有适当的权限

3. **图片识别失败**
   - 确保图片文件存在且可访问
   - 降低匹配度到0.7-0.8
   - 检查图片是否在屏幕可见

4. **鼠标点击位置不准**
   - 使用"获取当前位置"或"截图选择"
   - 检查屏幕缩放设置
   - 调整偏移量

### 获取帮助
- 查看程序内的"帮助"菜单
- 阅读完整的GUI_README.md文档
- 检查状态栏的执行信息

## 🎮 游戏使用场景

### 典型使用流程
1. **准备阶段**
   - 设置方便的全局快捷键
   - 创建并测试自动化脚本
   - 保存配置文件

2. **游戏中使用**
   - 进入游戏界面
   - 按启动快捷键开始执行
   - 需要时按停止快捷键终止

3. **调试优化**
   - 使用"测试此步骤"功能调试
   - 调整步骤参数和等待时间
   - 重新保存配置

### 快捷键建议
- **启动**：` 或 F1-F12（避免与游戏冲突）
- **停止**：ESC 或 F12（容易按到的键）
- **避免**：常用的字母键、数字键、空格键等

## 📦 打包为exe

如果需要打包成独立的exe文件：

1. 运行 `python build_exe.py`
2. 等待打包完成
3. 在dist目录中找到exe文件

## 🎯 示例配置

### 简单点击示例
1. 添加"鼠标点击"步骤
2. 设置坐标 (100, 200)
3. 选择左键点击
4. 保存并执行

### 图片搜索示例
1. 添加"图片搜索"步骤
2. 选择目标图片文件
3. 设置找到后动作为"左键点击"
4. 保存并执行

### 游戏自动化示例
1. 图片搜索并点击游戏按钮
2. 等待1秒
3. 按下Enter键
4. 等待2秒
5. 使用快捷键随时启动/停止

## 🎯 新功能亮点

### 🌟 全局快捷键系统
- **随时启动**：无需切换到程序窗口
- **即时停止**：遇到问题可立即终止
- **自定义设置**：支持设置任意快捷键
- **按键检测**：可视化按键检测功能

### 🛠️ 增强的用户体验
- **实时状态**：工具栏显示当前快捷键
- **一键设置**：简单易用的设置界面
- **安全退出**：程序关闭时自动清理快捷键监听

---

更多详细信息请参考 GUI_README.md 文档。
